# Blog 列表页功能更新

## 更新日期
2026-02-12

## 新增功能

### 1. 分类筛选
- 添加分类下拉选择器
- 支持按分类筛选文章
- 显示"全部分类"选项
- 分类数据从数据库动态加载

### 2. 搜索功能
- 添加搜索输入框
- 支持按标题和摘要搜索
- 使用 PostgreSQL 的 `ilike` 进行模糊搜索
- 支持回车键快速搜索

### 3. 分页功能
- 每页显示 10 条文章（可配置）
- 智能页码显示（最多显示 7 个页码）
- 上一页/下一页按钮
- 当前页高亮显示
- 分页保持筛选条件

### 4. 筛选条件显示
- 实时显示当前筛选条件
- 显示搜索关键词标签
- 显示选中的分类标签
- 清除筛选按钮

### 5. 结果统计
- 显示找到的主题总数
- 显示当前页码和总页数
- 动态更新统计信息

## 技术实现

### URL 参数
- `page`: 当前页码（默认 1）
- `category`: 分类 ID（可选）
- `search`: 搜索关键词（可选）

### 数据查询
```typescript
// 分类筛选
if (selectedCategory.value) {
  query = query.eq('category_id', selectedCategory.value)
}

// 搜索筛选
if (searchQuery.value) {
  query = query.or(`title.ilike.%${searchQuery.value}%,excerpt.ilike.%${searchQuery.value}%`)
}

// 分页
.range(offset, offset + POSTS_PER_PAGE - 1)
```

### 响应式设计
- 移动端优化的筛选器布局
- 搜索框和分类选择器在小屏幕上堆叠
- 分页按钮在移动端隐藏文字，只显示图标
- 触摸优化的按钮和输入框

## 用户体验优化

1. **筛选器卡片**
   - 清晰的标题和图标
   - 统一的品牌色设计
   - 平滑的过渡动画

2. **操作按钮**
   - "应用筛选"按钮（渐变背景）
   - "清除筛选"按钮（仅在有筛选条件时显示）
   - 悬停和点击动画效果

3. **当前筛选显示**
   - 彩色标签显示活动筛选条件
   - 搜索关键词标签（粉色）
   - 分类标签（紫色）

4. **结果统计**
   - 高亮显示主题总数
   - 清晰的页码信息

## 性能优化

1. **智能缓存**
   - 使用 `useAsyncData` 缓存查询结果
   - 基于页码、分类和搜索关键词的缓存键

2. **响应式查询**
   - 使用 `watch` 监听参数变化
   - 自动重新获取数据

3. **优化的数据库查询**
   - 使用 `count: 'exact'` 获取总数
   - 使用 `range` 进行分页
   - 只查询必要的字段

## 使用示例

### 访问所有文章
```
/blog
```

### 按分类筛选
```
/blog?category=category-id
```

### 搜索文章
```
/blog?search=关键词
```

### 组合筛选
```
/blog?category=category-id&search=关键词&page=2
```

## 未来改进建议

1. 添加排序功能（按时间、浏览量、评论数）
2. 添加标签筛选
3. 添加日期范围筛选
4. 添加高级搜索选项
5. 保存用户的筛选偏好
6. 添加筛选历史记录
